
# 应用构建服务

用友的应用构建除了通用的低代码平台能力，结合自身的平台、通用领域和行业应用，以及多行业不同规模客户的优势，重点聚焦下图所示的企业级应用所需要要的低代码平台核心能力：模型、事件、自动化、集成，以及数智中台。
    
应用构建以云原生、多租户、模型驱动为基础技术，将分散独立的构建模型通过可视化、业务组件装配方式有机的融为一体， 为开发者、实施、业务一线人员提供低代码甚至无代码的应用构建能力，快速满足业务变化、实现商业创新。
    
面向的人群扩大化后，产品上不可能大一统的去解决所有用户的诉求：没有任何编程基础的业务人员无法理解密密麻麻的代码；对于部分页面、逻辑、流程等只需要做简单的脚本扩展需求时没必要花费高昂的工资雇佣高级程序员、也没必要购买大量的运行资源进行部署运维；搭建一个完整的企业数字化平台势必需要有一批专业设计和开发人员参与，支持规范的开发上线全生命周期。
    
应用构建基于对于不同类型开发者和场景的分析，推出标准版和专业版两个版本产品。
    
在标准版中提供低门槛的无代码的声明式配置、在线低代码函数式开发两种模式，由应用构建平台提供多租户、安全可靠的公共引擎支撑和运维，用户无需关心代码和部署运维，这样可以让无代码开发经验的实施人员、业务员均可快速上手，去执行企业租户个性化的工作。标准版可视化构建过程由数据建模、页面建模、自动化（流程、RPA、函数）、集成连接、发布五个模块组成，五个模块中会提供贯穿应用全程的可视化设计器：实体设计器、查询元数据设计器、单据页面设计器、画布式页面设计器、打印模板设计器、工作流设计器、业务流程设计器、函数编程设计器，设计器内提供模型描述的组件，模型、组件、设计器、事件、函数等贯穿在可视化构建过程中，用户可以更加专注于自己的业务描述和创想实现。
    
应用构建服务专业版完全涵盖标准版的建模过程和设计器的能力之外，为用户提供自建应用引擎的创建、脚手架下载，本地开发调试、CICD、发布上线、生态应用上市的全生命周期管理。

不论是标准版还是专业版，都不应该直接在客户使用的生产环境上开发、测试新的应用或者更改，这样是不安全的，随意操作资源，有可能破坏其他应用程序正在使用的资源，或者造成数据泄漏，需要引入沙箱环境来实现，涉及到多个环境时有会牵扯到环境间的开发配置数据和代码如何迁移的问题。

## 应用构建平台 YonBuilder

应用构建平台的标准版入口在工作台下，为云上企业租户的实施和个性化提供声明式配置（无代码）、函数式开发（在线脚本）能力；应用构建平台的专业版入口在开发者中心下，面向开发者生态提供开发构建、开放连接、部署运维、在线运营的全生命周期能力。对于企业租户，有源码扩展、独立部署运维需求时，亦可在工作台的应用构建基础版内通过引导快速进入开发者中心进行专业版开发。 

### 数据建模

数据建模帮助开发者构建应用中的实体数据对象，提供应用中数据存储的基本服务，开发者只需要操作实体对象无需关心数据持久化过程中的数据存取、数据同步、读写分离等底层操作；

1、属性设计，字段名、字段名称、数据类型、应用类型；

2、校验规则，组合字段级别的业务唯一性校验、数据范围约束、自定义约束；

3、API接口，默认提供增、删、改、查接口，允许增加数据接口（POST、GET）；

4、支持数据索引；

5、支持实体之间的关联，关联关系根据应用类型分为主子表关联、数据引用关联、档案参照关联，支持1：n、n:n、n:1等多种关联关系；

6、预置工作流程属性，勾选后默认新增工作流预置字段，并匹配工作流关联；

7、预置业务流程属性，勾选后默认新增业务流预置字段，并匹配业务流关联；

8、预置实体审计信息属性；

9、数据关系查看，ER图的方式查看实体的关联引用对象；

10、支持多版本管理；

11、支持唯一性数据校验规则；

12、支持条件数据范围校验规则；

提供基于数据实体的关联及合并查询定义，为综合的数据应用提供基础。应用于页面设计中需要用到的数据关联查询，如已借出未归还的设备。应用构建业务流的数据来源中使用，业务流上的节点不仅仅来自单据，还可以来自一个数据的查询结果；还应用于多个对象建立报表，如“采购订单时效性报表”，通过元数据关联实现 ，跨领域多个对象建立综合报表。

提供新增查询的新增功能。

新增查询，输入编码名称后，点保存并设计后进入到查询设计器页面。

提供查询的编辑和删除的功能。

提供查询元数据的停用功能，停用后，在引用查询元数据的页面将不再看到；

提供拖拽式设计的查询设计器，通过拖拽选择要建立关系的实体或查询，被拖到画布上的对象按编码/名称的方式显示所有字段以备选；

通过拖拽创建关联关系（包含内关联、左关联、右关联），on部分自动添加简单关系（比如a表字段=b表字段）

关联关系支持复杂条件（on部分复杂条件）

支持创建union连接，默认union all的方式。

通过在实体上勾选，选择查询的显示字段，并显示在下面的列表上；

支持自定义维度和量度的定义（包含字段名、显示名称、类型、脚本，可以选择实体的字段、系统变量、权限标签）

自定义的字段需要支持表达式，比如：日期拆成日、周、月、年，文本拆成前5个、中间5个、最后5个等；

支持已选字段树构成一棵有层级关系的树展现，提供查询结果的查看界面；

数据过滤的设置，支持增删

a、逻辑符：支持与条件和或条件，当有多个条件时按现有的顺序执行；

b、过滤条件的操作符：包含/不包含、等于/不等于、大于/大于等于、小于/小于等于、开始是、结尾是、中间是

c、空值规则：空值返回所有数据/空值不返回数据，默认空值返回所有数据

d、值类型：包括常量、参数、系统变量、字段成员、权限标签，根据不同的类型，对应不同的取值；

常量：直接输入

参数：参数中定义的字段

系统变量：系统预置的变量，如当前年、当前月、当前季、当前年月、当前年季、当前日期、去年、当前用户、当前部门、当前组织……

权限标签：组织编码、组织名称、部门编码、部门名称……

字段成员：仅特定类型支持字段成员，比如：参照、枚举、日期等排序字段的设置，支持增删；

参数定义，参数可被过滤及自定义量度使用；支持增删和排序

参数的值类型为：字符、数值、日期、时间

是否必输：在数据模型执行时，是否必须输入值。为是时必输；

规则：空值返回所有数据/空值不返回数据

数据模型的建立支持视图模式和sql模式，两种方式是互斥的，默认视图模式；

### 功能建模

功能建模提供应用的功能页面设计器、组合页面设计器、报表设计器，支持不同功能业务页面的设计，同时支持前后端扩展，实现单据页面、画布页面、业务事件的构建和交互驱动过程的个性化扩展。

*	支持多种页面的创建：单据页面、表单页面、自由画布页面、数据分析页面
*	提供多种预置的页面模板，实现页面快速创建能力
*	web/移动多端页面整体管理，共享数据和配置类的资源设置
*	单据页面设计器预置多种模板：单表、单卡、树卡、树表、一主多子、主子孙表、交叉表、甬道表等，实现快速创建单据模板的能力；
*	单据页面设计器提供布局、数据容器、基础控件、业务控件、工具栏 、按钮等，用于单据页面的组装；
*	画布页面设计器提供多种布局和组件，支持流式和自由方式的页面组装
*	画布页面设计器支持数据集的定义和应用，支持数据连接和汇总加工能力
*	页面之间提供可视化配置的交互机制和能力
*	基于事件和脚本的个性化扩展能力
*	支持单据、工作流、业务流程的业务事件管理
*	提供丰富的函数，实现前后端扩展能力
*	支持原厂应用单据扩展设计能力
*	支持自定义组件接入

### 工作流

为开发者提供基础流程服务的能力，快速将流程应用于单据和页面的开发过程，工作流的能力与动态建模中的流程一直。

产品特性：
*	提供流程的分级管理，可按企业账号级或组织级来管理流程模型，支持流程的新增、编辑、删除、启用、停用、导入、导出及查询参与人；
*	基于单据类型及交易类型下的流程模型定义，单据类型下的流程定义支持发起条件；
*	提供图形化的流程设计器，支持通过拖拽组件创建流程；
*	流程引擎支持按用户、角色、部门、职务、岗位、部门负责人、发起人、单据字段、协作关系等多种方式设置参与人及抄送人；
*	流程引擎支持多种环节类型，包括活动、逐级活动、流程调用、服务、条件分支、执行流合并、消息通知等；
*	流程引擎支持同意、前后加签、改派、驳回、指派、跳转、暂存、提交、编辑、删除、撤回、复制、签名、终止等多种流程审批动作；
*	支持多种流程规则包括：连岗规则、撤回规则、超时处理规则、消息规则、指派规则、改派规则、多人操作时的处理规则、驳回规则、打印规则等；
*	支持按流程环节设置单据字段的权限：查看、编辑和隐藏；
*	支持流程的超时自动同意、发送超时消息等；
*	流程及流程环节支持配置自定义的消息模板，支持多通道多语言的配置；
*	支持流程查询、流程统计；
*	支持协作关系设置，有效解决复杂审批关系的定义。
*	提供流程调度和任务调度，流程管理员可从流程实例、任务实例的角度对流程进行监控和调度，包括删除、改派、终止、调整审批人、流程调整等；
*	提供流程管理员级的代理人设置及用户级的代理人设置。

### 业务流

YonBuilder应用构建平台的业务流是基于低代码平台的架构和方法，全新设计研发的新一代流程平台，快速构建、持续交付可以敏捷适应业务变化的企业级应用与服务。YonBuilder业务流超越了传统工作流或业务流程管理（BPM）的技术，不再局限于帮助企业或组织通过流程的可视化、规范化和迭代优化，提升可管理性、运营效率，以及降低损耗成本，而是在更高层面上抽象建模，使用阶段和各种不同类型步骤任务的动态组合，围绕企业或组织的业务目标，让流程更加动态、自动、智能，也更加友好易用。

产品特性：
    
**可视化设计 规范化控制**
*	支持图形化拖拽式的业务流程设计方式
*	支持上下游单据之间多规则设置
*	同时支持数据流转模式和业务流转模式

**业务管控  随需而变**
*	支持业务流程的自定义修改
*	支持单据正向的推单和反向的回写规则
*	回写支持逐级和跨级反写
*	支持流程版本管理
*	支持流程启用停用

**业务流程自动化 智能化**
*	支持自动拆合单规则设置
*	支持业务流程多种驱动方式：定时自动执行、手工执行 


### 打印

用友云打印是用友 iuap 企业互联网开放平台中的PaaS公有云服务，应用构建平台依托云打印提供与打印相关的平台、应用、工具和服务，包括打印模板的设计、打印模板的管理、以及预览和打印服务等。

产品特性：

*	支持按单据类型设置多个打印模板，支持设置默认模板；
*	提供打印模板管理功能，支持打印模板的创建、删除、保存、查询、启用和停用等；
*	提供打印模板设计器；
*	打印模板设计器提供多种控件、系统变量，支持页面设置、打印对象格式设置等；
*	提供预览和打印服务.

###  函数

在应用下支持开发者自定义根据确定输入信息，基于应用构建平台的脚本引擎，完成自定义逻辑的脚本编写；类型分为前端脚本和后端脚本，无论前端还是后端脚本都是以JS为语言规范，其中操作元数据是以平台提供的YonSQL对数据进行操作，YonSQL支持SQL95标准规范，与绝大部分SQL编写方式。

前端脚本：可用于控件状态控制、控件赋值、简单数据计算、openAPI调用；

后端脚本：可用于后端数据计算、业务调用、数据实体赋值、openAPI调用；

函数应用于单据页面、画布页面、流程（工作流、业务流）、表达式、变量、及作为通用函数使用。

有三种使用场景：
1、在应用构建中支持MDF扩展，有独立的函数资源管理，在页面中调用——单据页面设计器；

2、在具体的设计器中嵌入使用，没有独立的函数资源管理，在画布页面设计器、工作流设计器、业务流设计器中使用，由各设计器自行管理脚本，统一存储和调用执行；
    
3、作为通用扩展能力在支持在环境中支持扩展脚本能力，有独立的函数资源管理，表达式、变量、通用函数；

### 应用管理
应用管理提供应用的基本信息的维护，以及对外发布的服务和菜单的管理。

*	支持应用全部基本信息的维护
*	支持应用服务的发布，发布后可被系统其它模块调用
*	支持应用首页和菜单的发布
*	支持web/移动的应用发布

## 专业开发服务

应用构建平台专业版完全涵盖标准版的建模过程和设计器的能力之外，为用户提供自建应用引擎的创建、脚手架下载，本地开发调试、CICD、发布上线、生态应用上市的全生命周期管理。

应用构建平台的专业版入口在开发者中心下，面向开发者生态提供开发构建、开放连接、部署运维、在线运营的全生命周期能力。对于企业租户有源码扩展、独立部署运维需求时，亦可在工作台的应用构建基础版内通过引导快速进入开发者中心进行专业版开发。 

专业版除了涵盖标准版的全部设计和脚本能力之外，还可以支持开发者自建应用引擎来实现本地源码开发、独立运维部署等企业云服务高级定制能力，专业版的关键特性如下： 

*	涵盖标准版的全部配置、设计和在线脚本能力
*	脚手架下载、本地源码开发调试
*	无服务器模式，只需要开发自己的代码，一键部署，无需关心环境搭建和运维
*	通过沙箱、数据迁移和流水线上线流程实现多环境下的开发、验证、集成、发布上线的持续交付过程
*	支持构建产出的应用快速上载到云市场上市交易，实现生态共建
*	支持开放集成能力的快速连接
*	支持自定义组件、函数类型，开发、上传、发布到设计器中使用

专业版中有个核心的概念是应用引擎，如上高级定制特性便主要是通过自建应用引擎来实现的，通过应用引擎来融合技术中台、开放平台、云市场和应用构建的能力为开发者提供一站式的持续交付体验。

应用引擎是构建的应用所需的一整套运行环境，它开箱即用，开发者只需要关心基于引擎的脚手架快速开发实现自己的业务逻辑和特性，不需关心多环境的搭建、运维，代码部署、多环境间的数据升迁过程均可在应用引擎下快速操作完成。

标准版的应用构建过程统一都是由应用构建平台的公共引擎（公共引擎提供安全的多租户的模型驱动运行时）支撑的，在公共引擎上运行的应用不支持本地开发访问，当开发者有本地开发、独立运维的诉求时，可选择将公共引擎下的应用迁移到自建引擎下实现进一步的定制开发和部署运维。



